<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>E-Ticket | ketenangan jiwa</title>
  <style>
    :root {
      --bg: #0b1624;
      --card: #0f192b;
      --text: #e6edf5;
      --muted: #9cb1c7;
      --primary: #3b82f6;
      --border: #1f2b3e;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Poppins", system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #0b1624 0%, #0f192b 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }
    .card {
      width: 100%;
      max-width: 420px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
      text-align: center;
    }
    h1 { font-size: 1.4rem; margin-bottom: 8px; }
    p { color: var(--muted); margin-bottom: 12px; }
    .ref {
      display: inline-block;
      padding: 10px 16px;
      border: 1px dashed var(--primary);
      border-radius: 10px;
      color: var(--primary);
      font-weight: 700;
      letter-spacing: 0.5px;
      background: rgba(59,130,246,0.08);
    }
    .badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 12px;
      color: #22c55e;
      background: rgba(34,197,94,0.16);
      margin-bottom: 12px;
    }
    #qrWrap {
      margin: 22px 0 12px;
      text-align: center;
    }
    #qrBox {
      display: inline-flex;
      padding: 18px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: rgba(59,130,246,0.08);
    }
    #note {
      margin-top: 8px;
      color: #cad4eb;
    }
    .home {
      margin-top: 16px;
      display: inline-block;
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="badge">Tiket Digital</div>
    <h1 id="title">E-Ticket</h1>
    <p id="desc">Tunjukkan kode tiket ini saat registrasi.</p>
    <div id="refBox" class="ref">-</div>
    <div id="qrWrap" class="hidden">
      <p style="color: var(--muted); margin-bottom: 8px;">Tunjukkan QR ini ke panitia agar bisa dipindai saat check-in.</p>
      <div id="qrBox"></div>
    </div>
    <p id="note">Jika QR di email tidak terbuka, gunakan QR cadangan ini agar panitia bisa memindai atau ketik ulang kode referensi.</p>
    <a class="home" href="index.html#event">Kembali ke event</a>
  </div>
  <script src="js/vendor/qrcode.min.js"></script>
  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const ref = params.get("ref");
      const refBox = document.getElementById("refBox");
      const desc = document.getElementById("desc");
      const note = document.getElementById("note");
      const qrWrap = document.getElementById("qrWrap");
      const qrBox = document.getElementById("qrBox");

      if (ref) {
        refBox.textContent = ref;
        if (window.QRCode && qrWrap && qrBox) {
          const viewportWidth = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
          const safeWidth = Math.min(Math.max(viewportWidth - 72, 260), 360);
          const qrSize = Number.isFinite(safeWidth) ? Math.floor(safeWidth) : 280;
          new QRCode(qrBox, {
            text: ref,
            width: qrSize,
            height: qrSize,
            correctLevel: window.QRCode.CorrectLevel ? window.QRCode.CorrectLevel.M : 1,
          });
          qrWrap.classList.remove("hidden");
        } else if (qrWrap && qrBox) {
          qrBox.textContent = "QR tidak bisa dimuat. Gunakan kode di atas.";
          qrBox.style.color = "#e2e8f0";
          qrWrap.classList.remove("hidden");
        }
      } else {
        refBox.textContent = "Referensi tidak ditemukan";
        desc.textContent = "Tautan tiket tidak memiliki parameter ref.";
        note.textContent = "Silakan cek ulang email konfirmasi Anda.";
      }
    })();
  </script>
</body>
</html>
